<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Loan Amortization - The Realm of Data Science</title>
<meta name="description" content="Financial Modeling Series - Loan Amortization using vba &amp; Python ">


  <meta name="author" content="Pavitra Prabhu">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="The Realm of Data Science">
<meta property="og:title" content="Loan Amortization">
<meta property="og:url" content="http://localhost:4000/projects/loan_amortization/">


  <meta property="og:description" content="Financial Modeling Series - Loan Amortization using vba &amp; Python ">



  <meta property="og:image" content="http://localhost:4000/img/Project/ProjectTeaser/amortization.jpeg">





  <meta property="article:published_time" content="2021-02-14T21:12:28-06:00">





  

  


<link rel="canonical" href="http://localhost:4000/projects/loan_amortization/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Pavitra Prabhu",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="The Realm of Data Science Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          The Realm of Data Science
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/">Projects</a>
            </li><li class="masthead__menu-item">
              <a href="/learning/">Learning</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Pavitra Prabhu</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>My adventure in Data Science and Analytics</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Waukesha, WI</span>
        </li>
      

      
        
          
            <li><a href="mailto:pavitrashivananda.prabhu@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://github.com/prabhupavitra?tab=repositories" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Loan Amortization">
    <meta itemprop="description" content="Financial Modeling Series - Loan Amortization using vba &amp; Python">
    <meta itemprop="datePublished" content="2021-02-14T21:12:28-06:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Loan Amortization
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <style type="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
    }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML-full"></script>

<p><img src="/img/Project/ProjectTeaser/amort1.jpg" alt="this is a placeholder image" width="100%" height="50%" class="center" /></p>

<h4 id="introduction">Introduction</h4>

<p><span style="font-family:Georgia; font-size:18px;">
This article is part of a series about <strong>financial modeling</strong> using python/vba/R where I cover some of the prominent financial models useful for analysts. In this article we will explore loan amortization using Excel and Python. If you follow along for both, you’ll understand the concept at a deeper level, but feel free to navigate directly to the <a href="#loan-amortization-using-microsoft-excel">Excel</a> or <a href="#loan-amortization-using-python">Python</a> sections however you please.</span></p>

<p><span style="font-family:Georgia; font-size:18px;">
<strong>So, what does it mean when a loan is amortized?</strong></span> <br />
<span style="font-family:Georgia; font-size:18px;">
Amortization, derived from a Latin word <em>admortire</em>, which means “to kill”, simply refers to paying off an amount owed over time by making planned, incremental payments of principal and interest.</span></p>

<p><span style="font-family:Georgia; font-size:18px;"> In the following section, we will talk about some key terms on amortization before jumping onto the code and building a amortization schedule.</span></p>

<blockquote>
  <h5 id="amortization-schedule">Amortization Schedule</h5>
  <p><span style="font-family:Georgia; font-size:18px;"> An amortization schedule is a complete table of periodic loan payments, showing the amount of principal and the amount of interest that comprise each payment until the loan is paid off at the end of its term.</span></p>
</blockquote>

<blockquote>
  <h5 id="components-of-a-amortization-schedule-in-a-financial-model">Components of a Amortization Schedule in a Financial Model</h5>
  <ul>
    <li><span style="font-family:Georgia; font-size:18px;"> <strong>Loan amount</strong> : Original or expected balance for your mortgage/loan.</span></li>
    <li><span style="font-family:Georgia; font-size:18px;"> <strong>Term in years</strong> : The number of years over which you will repay this loan.</span></li>
    <li><span style="font-family:Georgia; font-size:18px;"> <strong>Interest rate</strong> : Annual fixed interest rate for this loan.</span></li>
    <li><span style="font-family:Georgia; font-size:18px;"> <strong>Payment per period</strong> : Also called as Equated Monthly Installment (EMI), includes principal payment and interest payment (PI). While each periodic -  payment is the same amount early in the schedule, the majority of each payment is interest; later in the schedule, the majority of each payment covers the loan’s principal.</span></li>
    <li><span style="font-family:Georgia; font-size:18px;"> <strong>Total interest</strong> : Total of all interest paid over the full term of the mortgage. This total interest amount assumes that there are no prepayments of principal.</span></li>
    <li><span style="font-family:Georgia; font-size:18px;"> <strong>Total payments</strong> : Total of all monthly payments over the full term of the mortgage. This total payment amount assumes that there are no prepayments of principal.</span></li>
  </ul>
</blockquote>

<p><span style="font-family:Georgia; font-size:18px;">
Next, lets discuss the design and layout of the amortization calculator that we are going to build in following sections. We shall build our excel amortization model with three sections: loan information/summary grid, loan EMI data table and an amortization schedule. </span></p>

<h4 id="loan-amortization-using-microsoft-excel">Loan Amortization using Microsoft Excel</h4>

<p><span style="font-family:Georgia; font-size:18px;">
We begin initializing our input to the amortization calculator, such as, the annual interest rate, amortization period, payments per year, and the loan amount (principal). Let’s consider a 30-year loan of 200,000 USD with monthly payments at an 8% annual rate of interest. This should require a monthly payment of $1,467.53 to fully amortize the loan.  </span></p>

<figure>
  <img src="/img/Project/p3/summary.png" alt="this is a placeholder image" width="100%" height="50%" class="center" />
  <figcaption style="color: grey"> Figure 1: Loan Summary </figcaption>
</figure>

<p><span style="font-family:Georgia; font-size:18px;">
The loan EMI data table is a table that does a sensitivity analysis on the loan information provided in the summary. This paragraph elaborates on the implementation of two-dimensional excel data tables to perform sensitivity analysis on the payment per period/EMI with loan term and the annual interest rate. Figure 2 illustrates the sensitivity analysis on the payment per period.</span></p>

<figure>
  <img src="/img/Project/p3/emi-comp-chart.png" alt="this is a placeholder image" width="100%" height="50%" class="center" />
  <figcaption style="color: grey"> Figure 2: Sensitivity analysis on the EMI with loan term and annual interest rate </figcaption>
</figure>

<p><span style="font-family:Georgia; font-size:18px;">
The upper left-hand corner of our data table contains, the formula as a reference to the payment per period(available in the loan summary section) .
We now use the Data Table command. We fill in both the Row input cell (indicating the cell that contains loan term in the loan summary) and the Column input cell (indicating the cell that contains annual interest rate in the loan summary). We then proceed with generating the loan amortization schedule.</span></p>

<figure>
  <img src="/img/Project/p3/amort-schedule.png" alt="this is a placeholder image" width="100%" height="50%" class="center" />
  <figcaption style="color: grey"> Figure 3: Loan amortization schedule for the input information in the loan summary.</figcaption>
</figure>

<p><span style="font-family:Georgia; font-size:18px;">
We will be using IF statements in the amortization table so that changes in the “Number of Years” and/or “Payments per Year” input variables will be correctly incorporated into the cells. We use the excel functions PMT, IPMT, and PPMT to compute the “Payment” and “Interest” and “Repayment of Principal” column entries, respectively. Figure 3 depicts amortization schedule for our input from loan summary section. To modify any of the cells or edit the worksheet, you can fork my <a href="https://github.com/prabhupavitra/Financial-Modeling/">github repository</a> or download this workbook by clicking on this <a href="https://github.com/prabhupavitra/Financial-Modeling/blob/master/CodeFiles/Amortization.xlsx">link</a>.</span></p>

<h4 id="loan-amortization-using-python">Loan Amortization using Python</h4>

<h5 id="references">References</h5>

<p><span style="font-family:Georgia; font-size:18px;">
(1) Benninga, Simon (April 2014). Financial Modeling. Cambridge, MA: MIT Press. ISBN: 9780262027281.</span>  <br />
<span style="font-family:Georgia; font-size:18px;">
(2) Ross, S. A., R. W. Westerfield, and J. Jaffe. 2010. Corporate Finance, 9th ed. McGraw-Hill.</span></p>


        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-02-14T21:12:28-06:00">February 14, 2021</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/projects/collaborative-filtering-using-pyspark/" class="pagination--pager" title="Implicit Collaborative Filtering with PySpark
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://github.com/prabhupavitra?tab=repositories" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Pavitra Prabhu. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










  </body>
</html>
